!function(e){var n=null,t=null,a="polyBC_";function r(e){for(var n="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=0;a<(e||5);a++)n+=t.charAt(Math.floor(Math.random()*t.length));return n}function s(){return(new Date).getTime()}function o(o){if(!e.localStorage)throw new"localStorage not available";var l=a+o,c=null===n;return this.channelId=l,t=t||r(),(n=n||{})[l]=n[l]||[],n[l].push(this),this.name=l+"::::"+r()+s(),c&&e.addEventListener("storage",i.bind(this),!1),this}function i(a){var r=a.key,s=a.newValue,o=!s,i=null;if(r.indexOf("eomBCmessage_")>-1&&!o){try{i=JSON.parse(s)}catch(e){throw new"Message conversion has resulted in an error."}if(i.tabId!==t&&i.channelId&&n&&n[i.channelId]){var l=n[i.channelId];for(var c in l)!l[c].closed&&l[c].onmessage&&l[c].onmessage(i.message);e.localStorage.removeItem(r)}}}o.prototype.onmessage=function(e){},o.prototype.postMessage=function(a){if(n){if(this.closed)throw new"This BroadcastChannel is closed.";var o=function(n){return{timestamp:s(),isTrusted:!0,target:null,currentTarget:null,data:n,bubbles:!1,cancelable:!1,defaultPrevented:!1,lastEventId:"",origin:e.location.origin}}(a),i=n[this.channelId]||[];for(var l in i)i[l].closed||i[l].name===this.name||i[l].onmessage&&i[l].onmessage(o);var c={channelId:this.channelId,bcId:this.name,tabId:t,message:o};try{var h=JSON.stringify(c),d="eomBCmessage_"+r()+"_"+this.channelId;e.localStorage.setItem(d,h)}catch(e){throw new"Message conversion has resulted in an error."}setTimeout(function(){e.localStorage.removeItem(d)},1e3)}},o.prototype.close=function(){this.closed=!0;var t=n[this.channelId].indexOf(this);t>-1&&n[this.channelId].splice(t,1),n[this.channelId].length||delete n[this.channelId],function(e){for(var n in e)if(e.hasOwnProperty(n))return!1;return!0}(n)&&e.removeEventListener("storage",i.bind(this))},e.BroadcastChannel=e.BroadcastChannel||o}(self);